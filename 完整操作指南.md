# 纸牌游戏完整操作指南

## 一、软件环境准备

### 1. 必需软件清单

#### 1.1 Cocos Creator（核心开发工具）
- **软件名称**：Cocos Creator
- **版本要求**：3.8.0 或更高版本
- **下载地址**：https://www.cocos.com/creator
- **用途**：游戏开发引擎，用于创建场景、编写代码、运行游戏

#### 1.2 Node.js（运行环境）
- **软件名称**：Node.js
- **版本要求**：14.0.0 或更高版本（推荐 LTS 版本）
- **下载地址**：https://nodejs.org/
- **用途**：提供 TypeScript 编译和包管理支持

#### 1.3 Git（版本控制）
- **软件名称**：Git
- **版本要求**：2.30.0 或更高版本
- **下载地址**：https://git-scm.com/
- **用途**：代码版本控制和 GitHub 上传

#### 1.4 Visual Studio Code（代码编辑器，可选但推荐）
- **软件名称**：Visual Studio Code
- **版本要求**：最新版本
- **下载地址**：https://code.visualstudio.com/
- **用途**：代码编辑和调试

### 2. 可选软件

#### 2.1 OBS Studio（视频录制）
- **软件名称**：OBS Studio
- **下载地址**：https://obsproject.com/
- **用途**：录制游戏演示视频

#### 2.2 图片编辑软件（资源制作）
- **推荐**：Photoshop、GIMP（免费）、或在线工具
- **用途**：制作和编辑卡牌图片

## 二、详细安装步骤

### 步骤1：安装 Node.js

1. **下载 Node.js**
   - 访问 https://nodejs.org/
   - 下载 LTS（长期支持）版本
   - 选择 Windows Installer (.msi)

2. **安装 Node.js**
   - 双击下载的安装包
   - 按照向导完成安装
   - **重要**：确保勾选 "Add to PATH" 选项

3. **验证安装**
   - 打开命令提示符（CMD）或 PowerShell
   - 输入命令：
     ```bash
     node --version
     npm --version
     ```
   - 如果显示版本号，说明安装成功

### 步骤2：安装 Cocos Creator

1. **下载 Cocos Creator**
   - 访问 https://www.cocos.com/creator
   - 点击"下载"按钮
   - 选择 Windows 版本下载

2. **安装 Cocos Creator**
   - 双击下载的安装包
   - 按照向导完成安装
   - 选择安装路径（建议使用默认路径）

3. **启动 Cocos Creator**
   - 首次启动需要注册/登录账号
   - 完成账号注册和登录

4. **验证安装**
   - 打开 Cocos Creator
   - 如果能看到主界面，说明安装成功

### 步骤3：安装 Git

1. **下载 Git**
   - 访问 https://git-scm.com/
   - 点击"Download for Windows"
   - 下载安装包

2. **安装 Git**
   - 双击下载的安装包
   - 按照向导完成安装
   - **重要设置**：
     - 选择 "Use Visual Studio Code as Git's default editor"（如果安装了 VS Code）
     - 选择 "Git from the command line and also from 3rd-party software"
     - 其他选项使用默认设置

3. **验证安装**
   - 打开命令提示符或 PowerShell
   - 输入命令：
     ```bash
     git --version
     ```
   - 如果显示版本号，说明安装成功

4. **配置 Git（首次使用）**
   ```bash
   git config --global user.name "你的名字"
   git config --global user.email "你的邮箱"
   ```

### 步骤4：安装 Visual Studio Code（可选但推荐）

1. **下载 VS Code**
   - 访问 https://code.visualstudio.com/
   - 点击"Download for Windows"
   - 下载安装包

2. **安装 VS Code**
   - 双击下载的安装包
   - 按照向导完成安装
   - **重要**：勾选 "Add to PATH" 选项

3. **安装推荐扩展**
   - 打开 VS Code
   - 点击左侧扩展图标
   - 搜索并安装以下扩展：
     - **TypeScript and JavaScript Language Features**（通常已内置）
     - **Cocos Creator**（如果有）

## 三、项目环境配置

### 步骤1：打开项目

1. **启动 Cocos Creator**
   - 双击桌面图标启动 Dashboard。
   - 在 Dashboard 中找到项目 `coco_poker`，点击打开。

2. **等待编辑器加载**
   - 首次打开可能需要编译 TypeScript 代码，请耐心等待底部的 "Asset DB" 和 "Compiling" 进度条完成。
   - 如果控制台没有报错（红色文字），说明项目加载正常。

### 步骤2：配置项目设置

1. **设置设计分辨率**
   - 点击顶部菜单栏的 `项目 (Project)` -> `项目设置 (Project Settings)`。
   - 在左侧选择 `项目数据 (Project Data)`。
   - 找到 `设计宽度 (Design Width)` 设置为 `1080`。
   - 找到 `设计高度 (Design Height)` 设置为 `2080`。
   - **适配屏幕宽度 (Fit Width)**：取消勾选。
   - **适配屏幕高度 (Fit Height)**：勾选（确保在不同手机上高度适配）。
   - 点击右上角的 `保存` 按钮，关闭窗口。

### 步骤3：创建与检查场景结构

**重要提示：你的层级管理器结构必须完全符合以下标准，否则 UI 无法正常显示。**

#### 1. 标准层级结构对照
请检查你的 `层级管理器`，最终结构应如下所示：

```
GameScene (场景根节点)
├── Main Light (灯光)
├── Main Camera (3D摄像机，可选，2D游戏可忽略或删除)
└── Canvas (UI根节点 - 必须有！)
    ├── Camera (UI摄像机 - 必须有！)
    ├── Background (背景节点)
    ├── PlayfieldArea (主牌区)
    ├── StackArea (发牌区)
    │   ├── ReserveStack (备用牌堆)
    │   └── BaseCardArea (底牌堆)
    └── UILayer (UI层)
        ├── UndoButton (回退按钮)
        └── ScoreLabel (分数文本)
```

#### 2. 修正你的层级结构（如果你的结构不对）

如果你发现 `PlayfieldArea`, `StackArea` 等节点在最外层（与 Main Camera 同级），说明缺少 **Canvas** 父节点。请按以下步骤修复：

1.  **创建 Canvas**：
    - 在层级管理器空白处右键 -> `创建` -> `UI 组件` -> `Canvas`。
    - 这会自动创建一个 `Canvas` 节点，并在其下创建一个 `Camera` 节点。

2.  **移动节点**：
    - 选中 `PlayfieldArea`、`StackArea`、`UILayer` 等所有 UI 节点。
    - 将它们 **拖拽** 到 `Canvas` 节点上，使它们成为 `Canvas` 的 **子节点**。

3.  **检查 Canvas 属性**：
    - 选中 `Canvas` 节点。
    - 属性检查器 -> `Node` -> `Position`：确保是 `0, 0, 0`。
    - 属性检查器 -> `UITransform` -> `Content Size`：确保是 `1080 x 2080`。

### 步骤4：详细节点创建步骤

如果需要从头创建，请按此步骤操作：

#### 1. 创建基础区域
1.  **PlayfieldArea (主牌区)**
    - 右键点击 `Canvas` -> `创建` -> `空节点 (Create Empty Node)`。
    - 重命名为 `PlayfieldArea`。
    - **属性设置**：
        - `Position`: 0, 290, 0 (根据布局调整)
        - `Size` (UITransform): 1080, 1500

2.  **StackArea (下方功能区)**
    - 右键点击 `Canvas` -> `创建` -> `空节点`。
    - 重命名为 `StackArea`。
    - **属性设置**：
        - `Position`: 0, -750, 0
        - `Size`: 1080, 580
    - **创建子节点**：
        - 右键 `StackArea` -> 创建空节点 -> 重命名 `ReserveStack` (位置 x: -270)。
        - 右键 `StackArea` -> 创建空节点 -> 重命名 `BaseCardArea` (位置 x: 270)。

3.  **UILayer (按钮与分数)**
    - 右键点击 `Canvas` -> `创建` -> `空节点`。
    - 重命名为 `UILayer`。
    - **添加回退按钮**：
        - 右键 `UILayer` -> `创建` -> `UI 组件` -> `Button`。
        - 重命名为 `UndoButton`。
        - 位置设为左下角或合适位置。
        - 展开 `UndoButton`，选中子节点 `Label`，修改 `String` 属性为 "回退"。
    - **添加分数标签**：
        - 右键 `UILayer` -> `创建` -> `UI 组件` -> `Label`。
        - 重命名为 `ScoreLabel`。
        - 修改 `String` 为 "0"。

### 步骤5：创建与配置卡牌预制体 (CardPrefab)

1.  **在场景中制作模板**
    - 右键 `Canvas` -> `创建` -> `2D 对象` -> `Sprite (精灵)`。
    - 重命名为 `Card`。
    - **添加组件**：
        - 选中 `Card` 节点。
        - 在属性检查器底部点击 `添加组件` -> 搜索 `CardView` -> 点击添加。

2.  **配置 CardView 属性**
    - 此时 `Card` 节点上应该有 `Sprite` 和 `CardView` 两个组件。
    - 找到 `CardView` 组件：
        - `Card Sprite`：将上方的 `Sprite` 组件拖进来（或者直接拖拽 Card 节点本身到这个框）。
        - `Card Back Sprite Frame`：从资源管理器找到 `card_back` 图片，拖入此框。
        - `Card Face Sprite Frames`：这是一个数组。点击 `Size` 输入 52。然后需要将 52 张牌面图片按顺序拖入（如果使用自动加载方案，此步可跳过，具体看代码实现）。**注意：** 当前代码使用的是 `CardResService` 自动组合资源，所以这里**不需要**手动拖拽 52 张图片，保持数组为空即可，或者根据代码逻辑配置通用背景。

3.  **保存为预制体**
    - 在资源管理器 `assets` 下新建文件夹 `prefabs`。
    - 将层级管理器中的 `Card` 节点 **拖拽** 到 `assets/prefabs` 文件夹中。
    - 此时 `Card` 节点在层级管理器中变绿，表示已关联预制体。
    - **删除** 场景中的 `Card` 节点（它只是个模板，游戏运行时会动态生成）。

### 步骤6：脚本挂载与引用绑定

1.  **挂载 GameScene**
    - 选中 `Canvas` 节点（或场景根节点，建议挂在 Canvas 上方便管理）。
    - 添加组件 -> `GameScene`。

2.  **挂载 GameController**
    - 在 `Canvas` 下创建一个空节点，命名为 `GameController`。
    - 添加组件 -> `GameController`。

3.  **绑定引用 (最关键的一步)**
    - 选中 `GameController` 节点，查看属性检查器。
    - **Game View**：拖拽 `UILayer` 节点到这里（需确保 UILayer 上有 GameView 脚本，如果没有，先给 UILayer 添加 `GameView` 组件）。
        - *修正*：通常 GameView 脚本挂在 UILayer 或 Canvas 上。确保 `UILayer` 节点添加了 `GameView` 组件。
    - **Playfield View**：给 `PlayfieldArea` 节点添加 `PlayfieldView` 组件，然后将 `PlayfieldArea` 节点拖给 GameController 的 `Playfield View` 属性。
    - **Stack View**：给 `ReserveStack` 节点添加 `StackView` 组件，拖拽给 GameController。
    - **Base Card View**：给 `BaseCardArea` 节点添加 `BaseCardView` 组件，拖拽给 GameController。
    - **Audio Controller**：如果有音频控制器，也在此绑定。

4.  **绑定 Prefab**
    - 选中 `PlayfieldArea` (PlayfieldView)，找到 `Card Prefab` 属性，将资源管理器中的 `CardPrefab` 拖进去。
    - 同样为 `StackView` 和 `BaseCardView` 绑定 `CardPrefab`。

## 四、运行和测试

### 步骤1：运行预览

1. **点击预览按钮**
   - 点击编辑器顶部的"预览"按钮（或按 `Ctrl + P`）
   - 等待浏览器打开

2. **测试功能**
   - 测试卡牌匹配功能
   - 测试翻牌功能
   - 测试回退功能

### 步骤2：调试

如果遇到问题：

1. **查看控制台**
   - 在 Cocos Creator 中打开"控制台"面板
   - 查看错误信息

2. **检查组件引用**
   - 确保所有 View 组件的引用都已正确配置
   - 确保预制体引用正确

3. **检查资源**
   - 确保所有图片资源都已正确导入
   - 确保 SpriteFrame 配置正确

## 五、常见问题解决

### Q1: Cocos Creator 无法启动

**解决方案**：
- 检查系统是否满足最低要求
- 尝试以管理员身份运行
- 重新安装 Cocos Creator

### Q2: TypeScript 编译错误

**解决方案**：
- 检查 Node.js 是否正确安装
- 检查 `tsconfig.json` 配置
- 尝试重新打开项目

### Q3: 资源加载失败

**解决方案**：
- 检查资源文件路径是否正确
- 确保资源文件在 `assets/resources/` 目录下
- 检查文件名和扩展名是否正确

### Q4: 组件引用丢失

**解决方案**：
- 重新配置组件引用
- 检查节点名称是否正确
- 确保组件已正确添加到节点

## 六、系统要求

### 最低系统要求

- **操作系统**：Windows 10 或更高版本
- **处理器**：Intel Core i3 或同等性能
- **内存**：4GB RAM（推荐 8GB）
- **硬盘空间**：至少 2GB 可用空间
- **显卡**：支持 OpenGL 3.3 或更高版本

### 推荐系统配置

- **操作系统**：Windows 11
- **处理器**：Intel Core i5 或更高
- **内存**：8GB RAM 或更多
- **硬盘空间**：5GB 可用空间（SSD 推荐）
- **显卡**：独立显卡

## 七、软件版本兼容性

### Cocos Creator 版本
- **推荐**：3.8.0
- **最低**：3.6.0
- **最高**：最新版本

### Node.js 版本
- **推荐**：18.x LTS
- **最低**：14.0.0
- **最高**：最新 LTS 版本

### TypeScript 版本
- 由 Cocos Creator 自动管理
- 通常为 4.x 版本

## 八、下一步操作

完成环境配置后，请参考：

1. **快速开始.md** - 快速上手指南
2. **资源准备指南.md** - 资源准备说明
3. **开发文档.md** - 详细开发文档
4. **GitHub上传和演示视频指南.md** - 上传和视频制作

---

**提示**：如果在安装或配置过程中遇到问题，请检查：
1. 系统是否满足最低要求
2. 软件版本是否兼容
3. 网络连接是否正常（下载软件时）
4. 防火墙是否阻止了软件运行

